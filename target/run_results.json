{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.2", "generated_at": "2025-06-27T13:26:16.640809Z", "invocation_id": "d056bd86-57f6-4aeb-9827-46153c3d8797", "invocation_started_at": "2025-06-27T13:26:14.876155Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.438177Z", "completed_at": "2025-06-27T13:26:16.459165Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.463625Z", "completed_at": "2025-06-27T13:26:16.463625Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029465436935424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.stg_clientes", "compiled": true, "compiled_code": "\n\nSELECT\n  id_bronze,\n  cliente_id,\n  nome,\n  cidade,\n  segmento,\n  data_carga\nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze\".\"clientes_bronze\"", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_bronze\".\"stg_clientes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.449956Z", "completed_at": "2025-06-27T13:26:16.464627Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.465803Z", "completed_at": "2025-06-27T13:26:16.465803Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030407190322875977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.stg_lojas", "compiled": true, "compiled_code": "\n\nSELECT\n  id_bronze,\n  loja_id,\n  nome,\n  cidade,\n  tamanho,\n  CURRENT_TIMESTAMP AS data_carga\nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze\".\"lojas_bronze\"", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_bronze\".\"stg_lojas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.454643Z", "completed_at": "2025-06-27T13:26:16.465803Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.467311Z", "completed_at": "2025-06-27T13:26:16.467311Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030635595321655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.stg_produtos", "compiled": true, "compiled_code": "\n\nSELECT\n  id_bronze,\n  produto_id,\n  nome,\n  categoria,\n  preco,\n  data_carga\nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze\".\"produtos_bronze\"", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_bronze\".\"stg_produtos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.459165Z", "completed_at": "2025-06-27T13:26:16.477535Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.485894Z", "completed_at": "2025-06-27T13:26:16.485894Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03376173973083496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.stg_vendas", "compiled": true, "compiled_code": "\n\nSELECT\n  id_bronze,\n  venda_id,\n  loja_id,\n  cliente_id,\n  produto_id,\n  quantidade,\n  data_venda,\n  total,\n  data_carga\nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze\".\"vendas_bronze\"", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_bronze\".\"stg_vendas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.470508Z", "completed_at": "2025-06-27T13:26:16.478598Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.487397Z", "completed_at": "2025-06-27T13:26:16.487397Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01889967918395996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.dim_clientes", "compiled": true, "compiled_code": "\n\nSELECT\n  cliente_id,\n  TRIM(nome) AS nome,\n  TRIM(cidade) AS cidade,\n  CASE \n    WHEN segmento IN ('Varejo', 'Atacado', 'Online') THEN segmento\n    ELSE 'Outros'\n  END AS segmento\nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze_bronze\".\"stg_clientes\"\nWHERE cliente_id IS NOT NULL", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"dim_clientes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.478598Z", "completed_at": "2025-06-27T13:26:16.495138Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.495138Z", "completed_at": "2025-06-27T13:26:16.495138Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019105911254882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.dim_lojas", "compiled": true, "compiled_code": "\n\nSELECT\n  loja_id,\n  TRIM(nome) AS nome,\n  TRIM(cidade) AS cidade,\n  -- Padroniza\u00e7\u00e3o de tamanhos\n  CASE \n    WHEN tamanho IS NULL THEN 'M\u00e9dia'\n    WHEN tamanho IN ('P', 'Pequena') THEN 'Pequena'\n    WHEN tamanho IN ('G', 'Grande') THEN 'Grande'\n    ELSE tamanho\n  END AS tamanho\nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze_bronze\".\"stg_lojas\"\nWHERE loja_id IS NOT NULL", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"dim_lojas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.482879Z", "completed_at": "2025-06-27T13:26:16.496144Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.496144Z", "completed_at": "2025-06-27T13:26:16.496144Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020111799240112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.dim_produtos", "compiled": true, "compiled_code": "\n\nSELECT\n  produto_id,\n  TRIM(nome) AS nome,\n  TRIM(categoria) AS categoria,\n  ROUND(preco, 2) AS preco\nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze_bronze\".\"stg_produtos\"\nWHERE produto_id IS NOT NULL\nAND preco > 0", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"dim_produtos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.490820Z", "completed_at": "2025-06-27T13:26:16.509486Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.518381Z", "completed_at": "2025-06-27T13:26:16.518381Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.028712749481201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.fato_vendas", "compiled": true, "compiled_code": "\n\nSELECT\n  v.venda_id,\n  v.loja_id,\n  v.cliente_id,\n  v.produto_id,\n  v.quantidade,\n  v.data_venda,\n  v.total,\n  v.total / NULLIF(v.quantidade, 0) AS preco_unitario\nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze_bronze\".\"stg_vendas\" v\nWHERE v.venda_id IS NOT NULL", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"fato_vendas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.501217Z", "completed_at": "2025-06-27T13:26:16.537370Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.539798Z", "completed_at": "2025-06-27T13:26:16.539798Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04104423522949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_vendas_dbt.accepted_values_dim_produtos_preco___0.b79705c65b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        preco as value_field,\n        count(*) as n_records\n\n    from \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"dim_produtos\"\n    group by preco\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '> 0'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.520824Z", "completed_at": "2025-06-27T13:26:16.541955Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.550827Z", "completed_at": "2025-06-27T13:26:16.550827Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03354668617248535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_vendas_dbt.not_null_dim_produtos_preco.e8705b524c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect preco\nfrom \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"dim_produtos\"\nwhere preco is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.531835Z", "completed_at": "2025-06-27T13:26:16.552337Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.554555Z", "completed_at": "2025-06-27T13:26:16.554555Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03727388381958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_vendas_dbt.not_null_dim_produtos_produto_key.d1190e95f3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect produto_key\nfrom \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"dim_produtos\"\nwhere produto_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.543170Z", "completed_at": "2025-06-27T13:26:16.561263Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.563543Z", "completed_at": "2025-06-27T13:26:16.563543Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02515244483947754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_vendas_dbt.unique_dim_produtos_produto_key.e4590ec76b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    produto_key as unique_field,\n    count(*) as n_records\n\nfrom \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"dim_produtos\"\nwhere produto_key is not null\ngroup by produto_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.555562Z", "completed_at": "2025-06-27T13:26:16.568378Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.570412Z", "completed_at": "2025-06-27T13:26:16.570412Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01958489418029785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.produtos_mais_vendidos", "compiled": true, "compiled_code": "\n\nSELECT\n  p.produto_id,\n  p.nome AS produto,\n  p.categoria,\n  COUNT(DISTINCT v.venda_id) AS vezes_vendido,\n  SUM(v.quantidade) AS unidades_vendidas,\n  SUM(v.total) AS receita_gerada,\n  ROUND(SUM(v.total) / NULLIF(SUM(v.quantidade), 0), 2) AS preco_medio_venda  \nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"fato_vendas\" v\nJOIN \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"dim_produtos\" p ON v.produto_id = p.produto_id \nGROUP BY 1, 2, 3\nORDER BY unidades_vendidas DESC\nLIMIT 50", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_gold\".\"produtos_mais_vendidos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.563543Z", "completed_at": "2025-06-27T13:26:16.576809Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.578325Z", "completed_at": "2025-06-27T13:26:16.578325Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019334793090820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.resumo_vendas", "compiled": true, "compiled_code": "\n\n-- Resumo consolidado de vendas\nSELECT\n  DATE_TRUNC('month', v.data_venda) AS mes,\n  COUNT(DISTINCT v.venda_id) AS total_vendas,\n  SUM(v.total) AS receita_total,\n  SUM(v.quantidade) AS total_itens_vendidos,\n  COUNT(DISTINCT v.cliente_id) AS clientes_ativos,\n  COUNT(DISTINCT v.loja_id) AS lojas_ativas,\n  ROUND(SUM(v.total) / NULLIF(COUNT(DISTINCT v.venda_id), 0), 2) AS ticket_medio\nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"fato_vendas\" v\nGROUP BY 1\nORDER BY 1", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_gold\".\"resumo_vendas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.571455Z", "completed_at": "2025-06-27T13:26:16.585663Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.592786Z", "completed_at": "2025-06-27T13:26:16.592786Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03046870231628418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dw_vendas_dbt.vendas_por_loja", "compiled": true, "compiled_code": "\n\nSELECT\n  l.loja_id,\n  l.nome AS nome_loja,\n  l.cidade AS cidade_loja,\n  l.tamanho AS tamanho_loja,\n  COUNT(DISTINCT v.venda_id) AS total_vendas,\n  SUM(v.total) AS receita_total,\n  COUNT(DISTINCT v.cliente_id) AS clientes_unicos,\n  SUM(v.quantidade) AS itens_vendidos,\n  ROUND(SUM(v.total) / NULLIF(COUNT(DISTINCT v.venda_id), 2)) AS ticket_medio\nFROM \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"fato_vendas\" v\nJOIN \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"dim_lojas\" l ON v.loja_id = l.loja_id  \nGROUP BY 1, 2, 3, 4\nORDER BY receita_total DESC", "relation_name": "\"dw_vendas_dbt\".\"dw_vendas_bronze_gold\".\"vendas_por_loja\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.579398Z", "completed_at": "2025-06-27T13:26:16.593962Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.596134Z", "completed_at": "2025-06-27T13:26:16.596134Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020392417907714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_vendas_dbt.not_null_fato_vendas_loja_key.0d01131e6b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect loja_key\nfrom \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"fato_vendas\"\nwhere loja_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.586769Z", "completed_at": "2025-06-27T13:26:16.595117Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.608468Z", "completed_at": "2025-06-27T13:26:16.608468Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03014349937438965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_vendas_dbt.not_null_fato_vendas_venda_key.e8ebe88a57", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect venda_key\nfrom \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"fato_vendas\"\nwhere venda_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.596134Z", "completed_at": "2025-06-27T13:26:16.617441Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.626319Z", "completed_at": "2025-06-27T13:26:16.626319Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03492331504821777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_vendas_dbt.relationships_fato_vendas_loja_key__loja_key__ref_dim_lojas_.94aa0bea01", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select loja_key as from_field\n    from \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"fato_vendas\"\n    where loja_key is not null\n),\n\nparent as (\n    select loja_key as to_field\n    from \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"dim_lojas\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.611738Z", "completed_at": "2025-06-27T13:26:16.631845Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.633169Z", "completed_at": "2025-06-27T13:26:16.633169Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02573227882385254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_vendas_dbt.unique_fato_vendas_venda_key.5d64310c2d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    venda_key as unique_field,\n    count(*) as n_records\n\nfrom \"dw_vendas_dbt\".\"dw_vendas_bronze_silver\".\"fato_vendas\"\nwhere venda_key is not null\ngroup by venda_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.618474Z", "completed_at": "2025-06-27T13:26:16.634350Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.634350Z", "completed_at": "2025-06-27T13:26:16.634350Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024878978729248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_vendas_dbt.not_null_produtos_mais_vendidos_produto.3b5517e93f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect produto\nfrom \"dw_vendas_dbt\".\"dw_vendas_bronze_gold\".\"produtos_mais_vendidos\"\nwhere produto is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-27T13:26:16.627314Z", "completed_at": "2025-06-27T13:26:16.635391Z"}, {"name": "execute", "started_at": "2025-06-27T13:26:16.636578Z", "completed_at": "2025-06-27T13:26:16.636578Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0206453800201416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dw_vendas_dbt.not_null_vendas_por_loja_ticket_medio.5be261d617", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_medio\nfrom \"dw_vendas_dbt\".\"dw_vendas_bronze_gold\".\"vendas_por_loja\"\nwhere ticket_medio is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.5706601142883301, "args": {"print": true, "defer": false, "cache_selected_only": false, "quiet": false, "source_freshness_run_project_hooks": true, "exclude": [], "show_resource_report": false, "version_check": true, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors_file": true, "indirect_selection": "eager", "introspect": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_all_warnings_handled_by_warn_error": false, "compile": true, "log_format": "default", "log_level_file": "debug", "state_modified_compare_more_unrendered_values": false, "vars": {}, "log_level": "info", "use_colors": true, "populate_cache": true, "profiles_dir": "C:\\Users\\dorri\\.dbt", "write_json": true, "require_nested_cumulative_type_params": false, "require_yaml_configuration_for_mf_time_spines": false, "show_all_deprecations": false, "strict_mode": false, "require_explicit_package_overrides_for_builtin_materializations": true, "validate_macro_args": false, "select": [], "log_format_file": "debug", "state_modified_compare_vars": false, "empty_catalog": false, "macro_debugging": false, "log_path": "C:\\Users\\dorri\\dw_vendas_dbt\\logs", "static": false, "static_parser": true, "upload_to_artifacts_ingest_api": false, "which": "generate", "partial_parse": true, "send_anonymous_usage_stats": true, "printer_width": 80, "log_file_max_bytes": 10485760, "favor_state": false, "use_fast_test_edges": false, "project_dir": "C:\\Users\\dorri\\dw_vendas_dbt", "require_resource_names_without_spaces": true, "partial_parse_file_diff": true, "invocation_command": "dbt docs generate", "skip_nodes_if_on_run_start_fails": false}}